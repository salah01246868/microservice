<div class="glass-card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2 style="margin:0">Gestion des Capteurs</h2>
        <button class="btn-primary" (click)="refresh()">Rafraîchir</button>
    </div>

    <!-- Formulaire d'Ajout/Edition -->
    <div class="glass-card" style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(255,255,255,0.05);">
        <h3 style="margin-top:0">{{ isEditing ? 'Modifier' : 'Ajouter' }} un Capteur</h3>
        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 200px;">
                <label style="display: block; margin-bottom: 0.5rem; font-size: 0.8rem;">Type</label>
                <select [(ngModel)]="currentSensor.type"
                    style="width: 100%; background: var(--glass-bg); color: white; border: 1px solid var(--glass-border); padding: 0.5rem; border-radius: 8px;">
                    <option value="HUMIDITE">Humidité</option>
                    <option value="TEMPERATURE">Température</option>
                    <option value="LUMINOSITE">Luminosité</option>
                </select>
            </div>
            <div style="flex: 1; min-width: 100px;">
                <label style="display: block; margin-bottom: 0.5rem; font-size: 0.8rem;">Parcelle ID</label>
                <input type="number" [(ngModel)]="currentSensor.parcelleId"
                    style="width: 100%; background: var(--glass-bg); color: white; border: 1px solid var(--glass-border); padding: 0.5rem; border-radius: 8px;">
            </div>
            <div style="flex: 2; min-width: 200px;">
                <label style="display: block; margin-bottom: 0.5rem; font-size: 0.8rem;">Emplacement</label>
                <input type="text" [(ngModel)]="currentSensor.emplacement" placeholder="Ex: Zone Nord"
                    style="width: 100%; background: var(--glass-bg); color: white; border: 1px solid var(--glass-border); padding: 0.5rem; border-radius: 8px;">
            </div>
            <div style="display: flex; align-items: flex-end; gap: 0.5rem;">
                <button class="btn-primary" (click)="saveSensor()">{{ isEditing ? 'Enregistrer' : 'Ajouter' }}</button>
                <button *ngIf="isEditing" class="btn-primary" style="background: rgba(255,255,255,0.1);"
                    (click)="resetForm()">Annuler</button>
            </div>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
        <div *ngFor="let s of sensors" class="glass-card" style="padding: 1.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                <div>
                    <h3 style="color: var(--secondary-color); margin-top: 0;">Capteur ID: {{s.id}}</h3>
                    <p><strong>Type:</strong> {{s.type}}</p>
                    <p><strong>Parcelle:</strong> {{s.parcelleId}}</p>
                    <p><strong>Emplacement:</strong> {{s.emplacement}}</p>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <button class="btn-primary" style="padding: 0.3rem 0.6rem; font-size: 0.7rem; background: #6366f1;"
                        (click)="editSensor(s)">Editer</button>
                    <button class="btn-primary" style="padding: 0.3rem 0.6rem; font-size: 0.7rem; background: #ef4444;"
                        (click)="deleteSensor(s.id)">Supprimer</button>
                </div>
            </div>
        </div>

        <div *ngIf="sensors.length === 0" class="glass-card"
            style="text-align: center; border: 1px dashed var(--glass-border); background: transparent;">
            <p>Aucun capteur trouvé.</p>
        </div>
    </div>
</div>